pipeline{
    //agent any
    agent {
        label 'slave-1'
    }
    //parameters {choice (choices : ['dev' , 'qa' , 'staging' , 'prod'],description : 'Choose dev or qa or staging or prod',name : 'ENV')
    environment {
        CON_NAME = 'react-con'
        IMG_NAME = 'sanjai:v1'
    }
    stages{
        stage('Build'){
            steps{
                script{
                    sh 'sudo su'
                    sh 'sudo docker stop ${CON_NAME}'
                    sh 'sudo docker rm -f ${CON_NAME}'
                    sh 'sudo docker rmi ${IMG_NAME}'
                    sh 'cd react-app ; bash build.sh'
                    
                                   }
            }

        }
        stage('Deploy'){
            steps{
                script{
                    sh 'cd react-app ; bash deploy.sh'

                }
            }
        }
    }
}
